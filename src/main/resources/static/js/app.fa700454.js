(function(){"use strict";var t={5958:function(t,e,r){var a=r(6369),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("app-header"),e("div",[e("router-view")],1)],1)},o=[],n=function(){var t=this,e=t._self._c;return e("div",[e("b-navbar",{attrs:{toggleable:"sm",type:"light",variant:"light"}},[e("b-navbar-brand",[t._v("iPass")]),e("b-navbar-nav",[e("b-nav-item",{attrs:{to:"/"}},[t._v("Home")]),e("b-nav-item",{attrs:{to:"/login"}},[t._v("Login")])],1)],1)],1)},i=[],c={name:"AppHeader"},u=c,d=r(1001),l=(0,d.Z)(u,n,i,!1,null,"30a9a3f0",null),p=l.exports,m={name:"App",components:{AppHeader:p}},h=m,g=(0,d.Z)(h,s,o,!1,null,null,null),f=g.exports,b=r(2631),v=function(){var t=this,e=t._self._c;return e("div",[e("product-page"),t.isLoggedIn?e("cart-page"):t._e(),t.isLoggedIn?t._e():e("b-alert",{attrs:{variant:"danger",dismissible:"",show:""},model:{value:t.showDismissibleAlert,callback:function(e){t.showDismissibleAlert=e},expression:"showDismissibleAlert"}},[t._v(" Please log in to use the store. ")])],1)},T=[],_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-md product-container"},t._l(t.products,(function(t){return e("product-tile",{key:t.id,attrs:{product:t}})})),1)},P=[],w=function(){var t=this,e=t._self._c;return e("div",{staticClass:"grid-container"},[e("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"20rem"},attrs:{title:t.product.displayName,"img-top":""}},[e("b-card-text",{staticStyle:{height:"100px"}},[e("img",{staticClass:"product-card-image",attrs:{src:t.product.imgUrl}})]),e("b-button",{attrs:{id:t.product.name+"-tooltip",variant:"primary",disabled:!t.isLoggedIn},on:{click:t.addToTransaction}},[t._v("€"+t._s(t.product.price))]),t.isLoggedIn?t._e():e("b-tooltip",{attrs:{target:t.product.name+"-tooltip",triggers:"hover"}},[t._v(" Please log in to access the store! ")])],1)],1)},y=[],k=r(530),L={name:"ProductTile",props:{product:{type:Object,required:!0}},methods:{addToTransaction(){this.$store.dispatch("addProductToTransaction",{product:this.product,amount:1})}},computed:{isLoggedIn(){return null!==(0,k.getAccessToken)()&&void 0!==(0,k.getAccessToken)()}}},x=L,C=(0,d.Z)(x,w,y,!1,null,"19a2e373",null),S=C.exports,U={name:"ProductPage",components:{ProductTile:S},computed:{products(){return[{id:1,name:"holyWood",price:2.45,displayName:"Holy Wood",imgUrl:"https://bep2022.blob.core.windows.net/images/palasanto.jpg"},{id:2,name:"spiritualBath",price:1.99,displayName:"Spiritual Bath",imgUrl:"https://bep2022.blob.core.windows.net/images/7Ghost.jpg"},{id:3,name:"smudgeStickSingle",price:2.99,displayName:"Smudge stick Single",imgUrl:"https://bep2022.blob.core.windows.net/images/smudgeStickSingle.jpg"},{id:4,name:"smudgeStickBundle",price:3.65,displayName:"Smudge stick Bundle",imgUrl:"https://bep2022.blob.core.windows.net/images/smudgeStickBundle.jpg"},{id:5,name:"cupping",price:19.99,displayName:"Cupping",imgUrl:"https://bep2022.blob.core.windows.net/images/cupping.jpg"},{id:6,name:"coffeeReading",price:29.99,displayName:"Coffee Reading",imgUrl:"https://bep2022.blob.core.windows.net/images/coffee.jpg"}]}}},$=U,I=(0,d.Z)($,_,P,!1,null,"3f7f522b",null),A=I.exports,j=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container-md cart-container"},[e("h2",[t._v("Cart")]),t._l(t.purchases,(function(t){return e("cart-tile",{key:t.product.id,attrs:{amount:t.amount,product:t.product}})})),e("b-button",{staticStyle:{width:"50%","align-self":"center"},attrs:{variant:"success",disabled:!t.isValidTransaction},on:{click:t.commitTransaction}},[t._v(t._s(t.purchaseString))])],2)},O=[],F=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"cart-tile-container"},[e("b-card",{staticClass:"card-top-class",attrs:{"body-class":"cart-card"}},[e("b-card-header",{staticClass:"cart-card-header"},[t._v(t._s(t.product.displayName))]),e("div",{staticClass:"card-main"},[e("b-card-text",{staticClass:"card-image-container"},[e("img",{staticClass:"card-image",attrs:{src:t.product.imgUrl}})]),e("b-card-text",{staticClass:"card-buttons"},[e("b-button",{attrs:{variant:"success"},on:{click:t.addToAmount}},[t._v("+")]),e("b-button",{attrs:{variant:"info",disabled:""}},[t._v(t._s(t.amount))]),e("b-button",{attrs:{variant:"warning"},on:{click:t.removeFromAmount}},[t._v("-")]),e("b-button",{attrs:{variant:"danger"},on:{click:t.removeProduct}},[t._v("Remove")])],1)],1)],1)],1)])},Z=[],E={name:"CartTile",props:{product:{type:Object,required:!0},amount:{type:Number,required:!0}},methods:{addToAmount(){this.$store.dispatch("addProductToTransaction",{product:this.product,amount:1})},removeFromAmount(){this.$store.dispatch("removeProductFromTransaction",this.product)},removeProduct(){this.$store.dispatch("removeProductCompletelyFromTransaction",this.product)}}},N=E,B=(0,d.Z)(N,F,Z,!1,null,"1997e4a1",null),q=B.exports,D={name:"CartPage",components:{CartTile:q},methods:{commitTransaction(){this.$store.dispatch("saveTransaction",this.$store.state.transaction)}},computed:{purchaseString(){return this.$store.state.transaction.purchases.length>0?"Buy (total price: €"+this.$store.state.transaction.totalPrice+")":"Put some items in the cart"},purchases(){return this.$store.state.transaction.purchases},totalPrice(){return this.$store.state.transaction.totalPrice},isValidTransaction(){return this.$store.state.transaction.purchases.length>0}}},H=D,R=(0,d.Z)(H,j,O,!1,null,"2bfbeb5e",null),M=R.exports,V={name:"AppHome",components:{ProductPage:A,CartPage:M},data(){return{showDismissibleAlert:!0}},computed:{isLoggedIn(){return this.$store.state.isUserLoggedIn}},mounted(){this.$store.dispatch("getProducts")}},G=V,W=(0,d.Z)(G,v,T,!1,null,"59e20f9a",null),z=W.exports,X=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[e("b-form",{staticClass:"login-box",attrs:{id:"login-form"},on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[t.isLoggedIn?t._e():e("b-form-group",{attrs:{id:"login-form-group"}},[e("b-form-input",{attrs:{id:"username-input",placeholder:"username",required:""},model:{value:t.username,callback:function(e){t.username=e},expression:"username"}}),e("b-form-input",{attrs:{id:"password-input",type:"password",placeholder:"password",required:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),t.isError?e("b-alert",{attrs:{show:"",variant:"danger",dismissible:""}},[t._v(t._s(t.error))]):t._e(),t.isLoggedIn?t._e():e("b-button",{attrs:{variant:"success",type:"submit",disabled:!t.isInputValid},on:{click:t.login}},[t._v("Login")]),t.isLoggedIn?e("div",[e("b-alert",{attrs:{show:"",variant:"secondary"}},[t._v("User "+t._s(t.getUsername)+" is logged in.")]),t.isLoggedIn?e("b-button",{attrs:{variant:"danger"},on:{click:t.logout}},[t._v("Logout")]):t._e()],1):t._e()],1)],1)},J=[],K=r(6265),Q=r.n(K);const Y="https://ipass-1.herokuapp.com",tt=Q().create({baseURL:Y}),et=t=>(console.log("refreshing token"),Q().post(`${Y}/authenticate`,{refresh:t}).then((t=>{console.log(t),t.data.token})));(0,k.applyAuthTokenInterceptor)(tt,{requestRefresh:et,header:"Authorization",headerPrefix:"Bearer "});const rt=async t=>{const e=await tt.post("/authenticate",t);(0,k.setAuthTokens)({accessToken:e.data.token,refreshToken:e.data.token})},at=()=>(0,k.clearAuthTokens)();var st={name:"AppLogin",data(){return{username:null,password:null,error:null}},methods:{async login(){this.clearError(),await rt({username:this.username,password:this.password}).catch((()=>this.error="Error while logging in")),this.error||(await this.$store.dispatch("setUserLoginState",!0),await this.$store.dispatch("setUsername",this.username),this.$router.push("/"))},clearError(){this.error=null},logout(){at(),this.$store.state.isUserLoggedIn=!1,this.$store.dispatch("setUserLoginState",!1),this.$store.dispatch("clearTransaction")}},computed:{isInputValid(){return null!==this.username&&null!==this.password&&""!==this.username&&""!==this.password},isLoggedIn(){return this.$store.state.isUserLoggedIn},getUsername(){return this.$store.state.username},isError(){return null!==this.error}},mounted(){this.error=null}},ot=st,nt=(0,d.Z)(ot,X,J,!1,null,"77a2d596",null),it=nt.exports;a["default"].use(b.Z);const ct=[{path:"/",component:z},{path:"/login",component:it},{path:"*",component:z}];var ut=new b.Z({mode:"history",routes:ct}),dt=r(3822);a["default"].use(dt.ZP);const lt="https://ipass-1.herokuapp.com";var pt=new dt.ZP.Store({state:{products:[],transaction:{purchases:[],timestamp:null,totalPrice:0},cart:[],error:null,loading:!1,isUserLoggedIn:!1,username:null},mutations:{setUsername(t,e){t.username=e},storeProducts(t,e){t.products=e},setUserLoginState(t,e){t.isUserLoggedIn=e},addProductToTransaction(t,e){const r=t.transaction.purchases.findIndex((t=>t.product.name===e.product.name));-1!==r?t.transaction.purchases[r]={product:e.product,amount:t.transaction.purchases[r].amount+1}:t.transaction.purchases.push(e)},removeProductFromTransaction(t,e){const r=t.transaction.purchases.findIndex((t=>t.product.name===e.name));t.transaction.purchases[r].amount>1?t.transaction.purchases[r]={product:e,amount:t.transaction.purchases[r].amount-1}:t.transaction.purchases.splice(r,1)},removeProductCompletelyFromTransaction(t,e){const r=t.transaction.purchases.findIndex((t=>t.product.name===e.name));t.transaction.purchases.splice(r,1)},updateTransactionTotalPrice(t){t.transaction.totalPrice=0,t.transaction.purchases.forEach((e=>{t.transaction.totalPrice+=e.product.price*e.amount})),t.transaction.totalPrice=(Math.round(100*t.transaction.totalPrice)/100).toFixed(2)},setTransactionTime(t,e){t.transaction.timestamp=e},setError(t,e){t.error=e},setLoading(t,e){t.loading=e},clearTransaction(t){t.transaction={purchases:[],timestamp:null,totalPrice:0}}},actions:{getProducts({commit:t}){t("setLoading",!0),tt.get(`${lt}/products`).then((e=>{t("storeProducts",e.data),t("setLoading",!1)})).catch((e=>{t("setError",e),t("setLoading",!1)}))},saveTransaction({commit:t},e){t("setLoading",!0),t("setTransactionTime",Date.now().toString()),tt.post("transactions",e).then((()=>{t("setLoading",!1)})).catch((e=>{t("setError",e),t("setLoading",!1)})),t("clearTransaction")},clearTransaction({commit:t}){t("clearTransaction")},updatePrice({commit:t}){t("updateTransactionTotalPrice")},addProductToTransaction({commit:t},e){t("addProductToTransaction",e),t("updateTransactionTotalPrice")},removeProductFromTransaction({commit:t},e){t("removeProductFromTransaction",e),t("updateTransactionTotalPrice")},removeProductCompletelyFromTransaction({commit:t},e){t("removeProductCompletelyFromTransaction",e),t("updateTransactionTotalPrice")},setUserLoginState({commit:t},e){t("setUserLoginState",e)},setUsername({commit:t},e){t("setUsername",e)}}}),mt=r(5996),ht=r(9425);r(7024);a["default"].config.productionTip=!1,a["default"].use(mt.XG7),a["default"].use(ht.A7),new a["default"]({router:ut,store:pt,render:t=>t(f)}).$mount("#app")}},e={};function r(a){var s=e[a];if(void 0!==s)return s.exports;var o=e[a]={exports:{}};return t[a].call(o.exports,o,o.exports,r),o.exports}r.m=t,function(){var t=[];r.O=function(e,a,s,o){if(!a){var n=1/0;for(d=0;d<t.length;d++){a=t[d][0],s=t[d][1],o=t[d][2];for(var i=!0,c=0;c<a.length;c++)(!1&o||n>=o)&&Object.keys(r.O).every((function(t){return r.O[t](a[c])}))?a.splice(c--,1):(i=!1,o<n&&(n=o));if(i){t.splice(d--,1);var u=s();void 0!==u&&(e=u)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[a,s,o]}}(),function(){r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,{a:e}),e}}(),function(){r.d=function(t,e){for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};r.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,o,n=a[0],i=a[1],c=a[2],u=0;if(n.some((function(e){return 0!==t[e]}))){for(s in i)r.o(i,s)&&(r.m[s]=i[s]);if(c)var d=c(r)}for(e&&e(a);u<n.length;u++)o=n[u],r.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return r.O(d)},a=self["webpackChunkipass_frontend"]=self["webpackChunkipass_frontend"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=r.O(void 0,[998],(function(){return r(5958)}));a=r.O(a)})();
//# sourceMappingURL=app.fa700454.js.map